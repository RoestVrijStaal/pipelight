From 8fbfc5aa064f6b915fbf97f2a74aadd45986707c Mon Sep 17 00:00:00 2001
From: Sebastian Lackner <sebastian@fds-team.de>
Date: Sun, 8 Sep 2013 12:33:23 +0200
Subject: d3d9/tests: Updated argument handling tests for
 GetAdapterDisplayModeEx

---
 dlls/d3d9/tests/d3d9ex.c |   11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/dlls/d3d9/tests/d3d9ex.c b/dlls/d3d9/tests/d3d9ex.c
index 06b286a..b371f5c 100644
--- a/dlls/d3d9/tests/d3d9ex.c
+++ b/dlls/d3d9/tests/d3d9ex.c
@@ -563,6 +563,17 @@ static void test_get_adapter_displaymode_ex(void)
      * is set to a value by GetAdapterDisplayModeEx(). */
     ok(mode_ex.ScanLineOrdering != 0, "ScanLineOrdering returned 0\n");
 
+    /* test GetAdapterDisplayModeEx with null pointer for D3DDISPLAYMODEEX */
+    rotation = (D3DDISPLAYROTATION)0xdeadbeef;
+
+    hr = IDirect3D9Ex_GetAdapterDisplayModeEx(d3d9ex, D3DADAPTER_DEFAULT, NULL, &rotation);
+    ok(SUCCEEDED(hr), "GetAdapterDisplayModeEx failed, hr %#x.\n", hr);
+    ok(rotation != (D3DDISPLAYROTATION)0xdeadbeef, "rotation is %d, expected != 0xdeadbeef", (int)rotation);
+
+    /* test GetAdapterDisplayModeEx with two null points */
+    hr = IDirect3D9Ex_GetAdapterDisplayModeEx(d3d9ex, D3DADAPTER_DEFAULT, NULL, NULL);
+    ok(hr == D3DERR_INVALIDCALL, "GetAdapterDisplayModeEx failed, hr %#x.\n", hr);
+
     /* return to the default mode */
     pChangeDisplaySettingsExA(NULL, NULL, NULL, 0, NULL);
 out:
-- 
1.7.9.5

